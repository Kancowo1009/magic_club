<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>ä¸­æ–‡ 3D é­”æ–¹ - é¡¯ç¤ºé‚„åŸè·¯å¾‘</title>
    <script type="module" src="https://cdn.cubing.net/js/cubing/twisty"></script>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background: #0f172a; color: white; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .card { background: #1e293b; padding: 25px; border-radius: 20px; width: 100%; max-width: 500px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        twisty-player { width: 100%; height: 320px; background: transparent; }
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 15px 0; }
        .label { grid-column: span 4; text-align: left; font-size: 0.9em; color: #94a3b8; margin-top: 10px; }
        button { padding: 12px 5px; border: none; border-radius: 8px; background: #334155; color: white; font-weight: bold; cursor: pointer; }
        button:hover { background: #475569; }
        .btn-solve { background: #10b981; flex: 2; padding: 15px; font-size: 1.1em; margin-top: 20px; }
        .btn-reset { background: #f59e0b; flex: 1; margin-top: 20px; }
        .display-box { margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 10px; text-align: left; }
        .path-text { color: #fbbf24; font-size: 0.95em; word-break: break-all; margin-top: 5px; }
        .solve-path { color: #4ade80; font-weight: bold; }
    </style>
</head>
<body>

    <div class="card">
        <h2>ğŸ§© ä¸­æ–‡ 3D é­”æ–¹åŠ©ç†</h2>
        <twisty-player id="cube" visualization="3D" control-panel="none" background="none"></twisty-player>

        <div class="grid">
            <div class="label">é †æ™‚é‡ï¼š</div>
            <button onclick="press('U', 'ä¸Šé †')">ä¸Šé †</button>
            <button onclick="press('D', 'ä¸‹é †')">ä¸‹é †</button>
            <button onclick="press('L', 'å·¦é †')">å·¦é †</button>
            <button onclick="press('R', 'å³é †')">å³é †</button>
            <button onclick="press('F', 'å‰é †')">å‰é †</button>
            <button onclick="press('B', 'å¾Œé †')">å¾Œé †</button>
        </div>

        <div class="grid">
            <div class="label">é€†æ™‚é‡ï¼š</div>
            <button onclick="press('U\'', 'ä¸Šé€†')">ä¸Šé€†</button>
            <button onclick="press('D\'', 'ä¸‹é€†')">ä¸‹é€†</button>
            <button onclick="press('L\'', 'å·¦é€†')">å·¦é€†</button>
            <button onclick="press('R\'', 'å³é€†')">å³é€†</button>
            <button onclick="press('F\'', 'å‰é€†')">å‰é€†</button>
            <button onclick="press('B\'', 'å¾Œé€†')">å¾Œé€†</button>
        </div>

        <div style="display:flex; gap:10px;">
            <button class="btn-reset" onclick="doReset()">é‡ç½®</button>
            <button class="btn-solve" onclick="doSolve()">âœ¨ åŸ·è¡Œé‚„åŸå‹•ç•«</button>
        </div>

        <div class="display-box">
            <div style="font-size: 0.8em; color: #94a3b8;">ç›®å‰äº‚åºç´€éŒ„ï¼š</div>
            <div id="history-display" class="path-text">ç„¡</div>
            <hr style="border: 0; border-top: 1px solid #334155; margin: 10px 0;">
            <div style="font-size: 0.8em; color: #94a3b8;">é‚„åŸæ­¥é©Ÿæ¸…å–®ï¼š</div>
            <div id="solve-display" class="path-text solve-path">ç­‰å¾…è¨ˆç®—...</div>
        </div>
    </div>

<script>
    const cube = document.getElementById('cube');
    const historyDisplay = document.getElementById('history-display');
    const solveDisplay = document.getElementById('solve-display');
    
    let history = []; 

    // å°ç…§è¡¨ï¼šè‹±æ–‡ä»£ç¢¼è½‰ä¸­æ–‡
    const chiMap = {
        'U': 'ä¸Šé †', 'D': 'ä¸‹é †', 'L': 'å·¦é †', 'R': 'å³é †', 'F': 'å‰é †', 'B': 'å¾Œé †',
        'U\'': 'ä¸Šé€†', 'D\'': 'ä¸‹é€†', 'L\'': 'å·¦é€†', 'R\'': 'å³é€†', 'F\'': 'å‰é€†', 'B\'': 'å¾Œé€†'
    };

    window.press = function(eng, chi) {
        history.push({eng, chi});
        cube.alg = history.map(item => item.eng).join(" ");
        historyDisplay.innerText = history.map(item => item.chi).join(" â†’ ");
        solveDisplay.innerText = "è«‹é»æ“Šé‚„åŸæŒ‰éˆ•";
    };

    window.doReset = function() {
        history = [];
        cube.alg = "";
        historyDisplay.innerText = "ç„¡";
        solveDisplay.innerText = "ç­‰å¾…è¨ˆç®—...";
    };

    window.doSolve = function() {
        if (history.length === 0) return;

        // è¨ˆç®—é‚„åŸè·¯å¾‘
        const solverSteps = history.slice().reverse().map(item => {
            let move = item.eng;
            let reversedEng = move.includes("'") ? move.replace("'", "") : move + "'";
            return {
                eng: reversedEng,
                chi: chiMap[reversedEng]
            };
        });

        // é¡¯ç¤ºè§£æ³•
        solveDisplay.innerText = solverSteps.map(s => s.chi).join(" â†’ ");

        // åŸ·è¡Œé‚„åŸå‹•ç•«
        const currentAlg = history.map(item => item.eng).join(" ");
        const solveAlg = solverSteps.map(item => item.eng).join(" ");
        
        // å°‡å®Œæ•´åºåˆ—çµ¦é­”æ–¹ï¼š(æ‰“äº‚å…¬å¼) + (è§£æ³•å…¬å¼)
        cube.alg = currentAlg + " " + solveAlg;
        
        // ç‚ºäº†è®“ä½¿ç”¨è€…çœ‹æ¸…æ¥šæ­¥é©Ÿï¼Œæˆ‘å€‘åŸ·è¡Œå®Œå¾Œä¸ç«‹åˆ»æ¸…ç©º
        history = []; 
    };
</script>

</body>
</html>